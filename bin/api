#!/usr/bin/env node
const inquirer = require("inquirer");
const rp = require("request-promise");
const ora = require("ora");
const { generator } = require("../lib/index");
const spinner = ora("Loading");
const path = require("path")
// 修改控制台字符串的样式
const message = [
  {
    name: "url",
    type: "input",
    message: "请输入api地址",
    validate(val) {
      if (val === "") {
        return "Address is required!";
      } else {
        return true;
      }
    },
  },
  {
    name: "type",
    type: "list",
    message: "请选择文档类型",
    choices: ["Swagger", "Yaml"],
    validate(val) {
      console.log(val);
      if (val === "") return "The url is required!";
      return true;
    },
  },
];

inquirer.prompt(message).then((res) => {
  spinner.start();
  rp({ uri: res.url, method: "GET" })
    .then(generator)
    .finally(() => spinner.stop());
});
